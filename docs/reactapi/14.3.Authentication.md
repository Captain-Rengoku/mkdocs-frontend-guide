# Authentication & Authorization in React — Topics List

<!-- - **1. Fundamentals**
      - What is Authentication?
      - What is Authorization?
      - Differences Between Auth & AuthZ
      - Types of Authentication (Session, Token, OAuth, etc.)
      - SPA Authentication Challenges
- **2. Authentication Methods in React**
      - Cookie-Based Authentication
      - Token-Based Authentication (JWT)
      - OAuth 2.0
      - OpenID Connect
      - Social Login (Google, GitHub, Facebook)
      - Passwordless Authentication
      - Magic Links / OTP Auth
- **3. Handling JWT in React**
      - Access Token
      - Refresh Token
      - Token Expiry & Auto-Refresh
      - Secure Storage (Cookie vs LocalStorage)
      - HttpOnly Cookies
- **4. Authorization Concepts**
      - Role-Based Access Control (RBAC)
      - Permission-Based Access Control (PBAC)
      - Attribute-Based Access Control (ABAC)
      - Route-Level Authorization
      - Component-Level Authorization
- **5. State Management for Auth**
      - Auth Context API
      - Redux Toolkit for Auth
      - Zustand Auth Store
      - React Query + JWT
      - Using React Query for Protected Data Fetching
- **6. Protecting Routes in React**
      - Private Routes (React Router)
      - Public vs Protected Routes
      - Conditional Rendering based on Auth State
      - Redirects (Unauthenticated → Login)
      - Preventing Authenticated Users from Visiting Login/Register
- **7. Secure API Communication**
      - Attaching Tokens to Requests
      - Axios Interceptors for Auth
      - Fetch API with Auth Headers
      - Refresh Token Logic in Interceptors
- **8. Security Best Practices**
      - Avoid Storing JWT in LocalStorage
      - CSRF vs XSS
      - HttpOnly Cookies
      - Rate Limiting & Brute Force Protection (Backend)
      - Secure Logout (Token Invalidation)
      - Checking Token Signature & Expiry
- **9. Authentication Libraries for React**
      - Firebase Authentication
      - Auth0
      - Supertokens
      - Clerk
      - NextAuth.js (for Next.js)
      - AWS Cognito
      - Supabase Auth
- **10. Building a Custom Auth System**
      - Building Login with API
      - Signup + Validation
      - Storing Tokens Securely
      - Maintaining Auth State Globally
      - Auto Login on Page Refresh
      - Logout Flow
- **11. Handling Edge Cases**
      - Token Expired Mid-Session
      - Token Tampering
      - Slow Network & Suspense UI
      - Network Errors on Protected Routes
      - Protecting Sensitive UI from Flashing
- **12. Advanced Topics**
      - Authorization Middleware (React Router)
      - Access Control Using Higher Order Components (HOCs)
      - Authentication Guards
      - Multi-Tenant Authorization
      - Role-Based UI Rendering
      - Using Server-Side Authorization (Next.js)
- **13. Testing Auth**
      - Unit Testing Auth Context / Store
      - Integration Testing Protected Routes
      - Mocking Tokens
      - Mocking Auth API
      - E2E Testing with Auth (Cypress / Playwright) -->

---

## {++ Fundamentals of Authentication & Authorization ++}

This section covers the essential concepts of authentication and authorization in React and modern web applications.

### Understanding Authentication

Authentication means **verifying who the user is**.  
It ensures the user is a real, valid identity before giving access.

#### Authentication Examples

- Email + password login  
- OTP login  
- Google / GitHub login  
- Magic link login  
- Biometric login (FaceID, fingerprint)

```jsx
// Login.jsx
import { useState } from "react";
import axios from "axios";

export default function Login() {
  const [email, setEmail] = useState("");
  const [password, setPassword] = useState("");

  async function handleLogin(e) {
    e.preventDefault();
    await axios.post("/api/login", { email, password }, { withCredentials: true });
  }

  return (
    <form onSubmit={handleLogin}>
      <input 
        value={email} 
        onChange={(e) => setEmail(e.target.value)} 
        placeholder="email" 
      />
      <input 
        type="password" 
        value={password} 
        onChange={(e) => setPassword(e.target.value)} 
        placeholder="password" 
      />
      <button type="submit">Login</button>
    </form>
  );
}
```

### Understanding Authorization

Authorization means **deciding what an authenticated user is allowed to do**.

It determines:

- Which pages users can view  
- Which actions they can perform  
- What information they can access  

#### Authorization Examples

- Admin can delete users  
- Students can view only their own marks  
- Logged-out users cannot access dashboards  

### Authentication vs Authorization

| Feature  | Authentication    | Authorization          |
| -------- | ----------------- | ---------------------- |
| Meaning  | Verifies identity | Verifies permissions   |
| Question | "Who are you?"    | "What can you access?" |
| Happens  | First             | Second                 |
| Example  | Login form        | Accessing admin panel  |

#### Access Flow Diagram

```text
User → Authentication (identity check) → Authorization (permissions check) → Access Granted
```

### Types of Authentication Methods

#### Session-Based Authentication Overview

- Server stores a session ID  
- Browser stores a session cookie  

```text
Client → sessionID cookie → Server checks session → Access Granted
```

#### Token-Based Authentication Overview (JWT)

- Common in React apps  
- Server generates a JWT  
- Token stored in **HttpOnly cookies**

```text
Client → JWT token → Server verifies signature → Access Granted
```

#### OAuth Login Overview

- Used for “Login with Google”  
- Third-party authentication provider  

#### OpenID Connect Overview

- Extension on OAuth  
- Provides identity info (email, profile, etc.)

#### Passwordless Login Overview

- OTP login  
- Magic link login  
- Biometric login  

#### Multi-Factor Authentication Overview

- Requires more than one verification step (password + OTP)

### SPA Authentication Challenges

React apps run entirely in the browser, so they face unique issues.

#### Token Storage Concerns

- ❌ Avoid using localStorage due to XSS  
- ✔️ Prefer HttpOnly cookies  

#### Route Protection Logic

React must hide private content from unauthenticated users.

```jsx
// ProtectedRoute.jsx
import { Navigate } from "react-router-dom";

export default function ProtectedRoute({ children }) {
  const loggedIn = document.cookie.includes("token=");
  return loggedIn ? children : <Navigate to="/login" />;
}
```

#### Token Expiry Handling

SPAs must manage:

- Token expiration  
- Silent re-login  
- Refresh tokens  

#### UI Flash Problem

Protected UI may show briefly before auth loads.

Solutions:

- Loading placeholders  
- Initial auth checking  

#### CORS Configuration Concerns

When frontend & backend have different origins:

- Enable `withCredentials: true`  
- Configure backend CORS properly  

---

## {++ Authentication Methods in React ++}

This section explains the main ways authentication is implemented in React applications, from traditional cookies to modern passwordless login.

### Cookie-Based Authentication

In cookie-based auth, the **server stores the session**, and the browser stores a **session cookie**.  
React automatically sends cookies with requests (if `withCredentials` is enabled).

#### Cookie Authentication Characteristics

- Server-managed session  
- HttpOnly cookies recommended  
- Automatic cookie handling  
- Protected from XSS (when HttpOnly)

#### Cookie Authentication Example

```js
// login route (server)
res.cookie("sessionId", "abc123", {
  httpOnly: true,
  secure: true,
});
res.json({ message: "Logged in" });
```

### Token-Based Authentication (JWT)

In JWT authentication, the server returns a **signed token**.  
React sends this token back with each request (usually stored in cookies).

#### JWT Authentication Characteristics

- Stateless (no server session)  
- Token contains user data (id, role)  
- Works well with SPAs  
- Must be stored securely (HttpOnly cookie recommended)

#### JWT Authentication Example

```js
// server
const token = createJwt({ id: user.id });
res.cookie("token", token, { httpOnly: true });
```

### OAuth2 Authentication

OAuth2 is used when logging in with **third-party providers** (e.g., Google, GitHub).  
The provider verifies identity and redirects back with an authorization code.

#### OAuth2 Characteristics

- User authenticates at provider  
- Backend exchanges code for access token  
- No password needed in your app  
- Very secure and standardized  

#### OAuth2 Flow Example

```text
React → Provider Login Page → User Authorizes → Backend → Token Issued
```

### OpenID Connect Authentication

OpenID Connect (OIDC) sits on top of OAuth2 and provides **identity information** (email, name, picture).

#### OIDC Characteristics

- Uses ID Token (JWT)  
- Provides verified user identity  
- Ideal for modern “Login with …” systems  

### Social Login Authentication

React apps commonly support login using:

- Google  
- GitHub  
- Facebook  
- Twitter  
- Microsoft  

#### Social Login Characteristics

- Quick login  
- No password needed  
- Uses OAuth or OIDC under the hood  

### Passwordless Authentication

Passwordless login removes passwords entirely.  
User verifies using a one-time method.

#### Passwordless Characteristics

- No password stored  
- No password to forget  
- Uses email or phone  

#### Passwordless Login Example

```text
User enters email → App sends OTP/magic link → User clicks → Logged in
```

### Magic Link and OTP Authentication

Magic links and OTPs are modern and widely used.  
User receives a one-time login link or code.

#### Magic Link / OTP Characteristics

- Secure and user-friendly  
- No passwords required  
- Common in SaaS and mobile apps  

#### OTP Example Flow

```text
Enter phone/email → Receive OTP → Submit OTP → Verify → Logged in
```

---

## {++ Handling JWT in React ++}

JWT (JSON Web Token) is one of the most common authentication methods in modern React applications.  
This section explains how JWT works, how to store it safely, and how to handle expiry.

### Understanding Access Tokens

Access Tokens are short-lived tokens used to access protected APIs.  
They contain user identity and permissions in a signed format.

#### Access Token Characteristics

- Short-lived (5–15 minutes recommended)  
- Sent automatically by cookies or manually via headers  
- Validated on every request  
- Used only for authorization, not identity storage in React state  

#### Access Token Request Example

```js
// Axios request sending access token (if stored manually)
api.get("/profile", {
  headers: {
    Authorization: `Bearer ${accessToken}`,
  },
});
```

### Understanding Refresh Tokens

Refresh Tokens are long-lived tokens used to **get new access tokens** when they expire.  
React does not store refresh tokens — the **server stores it in HttpOnly cookies**.

#### Refresh Token Characteristics

- Long-lived (days or weeks)  
- Must be stored in HttpOnly cookies  
- Never exposed to JavaScript  
- Used only on a `/refresh` endpoint  

#### Refresh Token Flow Example

```text
Access Token expired → React calls /refresh → Server verifies refresh token → New access token returned
```

### Handling Token Expiry and Auto-Refresh

React must detect when the Access Token expires and automatically refresh it.

#### Auto Refresh Flow

```text
Request → 401 Unauthorized → React triggers /refresh → Retry original request
```

#### Axios Auto-Refresh Example

```js
// axios interceptor
api.interceptors.response.use(
  res => res,
  async err => {
    if (err.response?.status === 401) {
      await api.post("/refresh", {}, { withCredentials: true });
      return api(err.config); // retry request
    }
    return Promise.reject(err);
  }
);
```

### Secure Token Storage in React

Choosing where to store tokens is critical for security.

#### Token Storage Comparison

**localStorage:**  

- ❌ Vulnerable to XSS  
- ❌ Token can be stolen  
- ❌ Not recommended for JWT auth  

**HttpOnly Cookies:**  

- ✔️ Cannot be read by JavaScript  
- ✔️ Protection from XSS  
- ✔️ Automatically sent with requests  
- ⭐ Recommended for React apps  

### HttpOnly Cookies in JWT Auth

An HttpOnly cookie prevents JavaScript from accessing the token.

#### HttpOnly Cookie Characteristics

- Invisible to JS (`document.cookie` cannot read it)  
- Safe from XSS attacks  
- Sent automatically with `withCredentials: true`  
- Should always be paired with `SameSite` and `Secure` flags  

#### HttpOnly Cookie Example

```js
// server sets HttpOnly cookie
res.cookie("token", jwt, {
  httpOnly: true,
  secure: true,
  sameSite: "strict",
});
res.json({ message: "Logged in" });
```
